CREATE TABLE students_sample_1 AS SELECT students.* FROM students JOIN ( SELECT zipcode, count(1)/1107756 ratio FROM students GROUP BY zipcode) temp ON (students.zipcode = temp.zipcode)  WHERE rand() < ratio;
CREATE TABLE students_sample_2 AS SELECT students.* FROM students JOIN ( SELECT lname,state, count(1)/1107756 ratio FROM students GROUP BY lname,state) temp ON (students.lname = temp.lname)  WHERE rand() < ratio;
CREATE TABLE students_sample_3 AS SELECT students.* FROM students JOIN ( SELECT lname, count(1)/1107756 ratio FROM students GROUP BY lname) temp ON (students.lname = temp.lname)  WHERE rand() < ratio;
CREATE TABLE students_sample_4 AS SELECT students.* FROM students JOIN ( SELECT contact_number,weight, count(1)/1107756 ratio FROM students WHERE weight <= 118.11 GROUP BY contact_number,weight) temp ON (students.contact_number = temp.contact_number)  WHERE rand() < ratio;
CREATE TABLE students_sample_5 AS SELECT students.* FROM students JOIN ( SELECT number_cousins, count(1)/1107756 ratio FROM students WHERE number_cousins <= 16 GROUP BY number_cousins) temp ON (students.number_cousins = temp.number_cousins)  WHERE rand() < ratio;
CREATE TABLE students_sample_6 AS SELECT students.* FROM students JOIN ( SELECT major,number_siblings, count(1)/1107756 ratio FROM students WHERE number_siblings <= 1 GROUP BY major,number_siblings) temp ON (students.major = temp.major)  WHERE rand() < ratio;
CREATE TABLE students_sample_7 AS SELECT students.* FROM students JOIN ( SELECT country, count(1)/1107756 ratio FROM students GROUP BY country) temp ON (students.country = temp.country)  WHERE rand() < ratio;
quit;